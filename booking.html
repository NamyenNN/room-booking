<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="color-scheme" content="light dark">
<title>‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</title>
<link rel="icon" type="image/png" href="https://namyennn.github.io/room-booking/LOGOCS.png?v=1">

<style>
  /* ============== THEME TOKENS (Light default) ============== */
  :root{
    --bg: #f3f4f6;        /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ô‡∏≠‡∏Å */
    --text: #0f172a;
    --muted:#64748b;
    --card:#ffffff;       /* ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏´‡∏•‡∏±‡∏Å */
    --subcard:#f9fafb;    /* ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô */
    --line:#e5e7eb;
    --border:#e5e7eb;     /* (‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏´‡πâ) ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö dashed border */
    --primary:#3b82f6;
    --primary-press:#2563eb;
    --input-bg:#ffffff;
  }
  @media (prefers-color-scheme: dark){
    :root{
      --bg:#020617;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --card:#020617;
      --subcard:#020617;
      --line:#1f2937;
      --border:#1f2937;
      --primary:#60a5fa;
      --primary-press:#3b82f6;
      --input-bg:#020617;
    }
  }
  body.force-light{
    --bg: #f3f4f6;
    --text: #0f172a;
    --muted:#64748b;
    --card:#ffffff;
    --subcard:#f9fafb;
    --line:#e5e7eb;
    --border:#e5e7eb;
    --primary:#3b82f6;
    --primary-press:#2563eb;
    --input-bg:#ffffff;
  }
  body.force-dark{
    --bg:#020617;
    --text:#e5e7eb;
    --muted:#94a3b8;
    --card:#020617;
    --subcard:#020617;
    --line:#1f2937;
    --border:#1f2937;
    --primary:#60a5fa;
    --primary-press:#3b82f6;
    --input-bg:#020617;
  }

  /* ============== BASE LAYOUT ============== */
  html,body{height:100%}
  body{
    font-family:system-ui,Segoe UI,Arial;
    padding:16px;
    background:var(--bg);
    color:var(--text);
    display:flex;
    justify-content:center;
  }

  .page{ width:100%; max-width:760px; }

  .page-card{
    background:var(--card);
    border-radius:18px;
    border:1px solid var(--line);
    padding:18px 16px 20px;
    box-shadow:0 16px 40px rgba(15,23,42,.12);
  }

  fieldset{
    border:1px solid var(--line);
    padding:14px 14px 16px;
    margin-bottom:14px;
    border-radius:14px;
    background:var(--subcard);
  }
  fieldset legend{
    padding:0 6px;
    font-size:14px;
    font-weight:600;
    color:var(--muted);
  }

  label{display:block;margin:6px 0 4px;color:var(--muted);font-size:13px}
  input,select,button,textarea{
    width:100%;
    padding:10px;
    border-radius:12px;
    border:1px solid var(--line);
    background:var(--input-bg);
    color:var(--text);
    font:inherit;
  }
  textarea{resize:vertical}
  input:focus,select:focus,textarea:focus{
    outline:none;
    border-color:var(--primary);
    box-shadow:0 0 0 4px rgba(59,130,246,.18);
  }

  header.header-flex{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    margin-bottom:14px;
  }
  .brand-group{
    display:flex;
    align-items:center;
    gap:12px;
  }
  .brand-group img{
    width:52px;height:52px;border-radius:12px;object-fit:contain;border:1px solid var(--line);background:var(--input-bg);
  }
  .brand-group h1{
    margin:0;
    font-size:22px;
    font-weight:800;
    letter-spacing:.2px;
  }
  .subtitle{
    font-size:12px;
    color:var(--muted);
    margin-top:2px;
  }

  .form-grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px;
  }

  .status-grid{
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:12px;
    margin-top:10px;
  }
  .status-card{
    background:var(--card);
    padding:12px;
    border-radius:14px;
    border:1px solid var(--line);
    text-align:center;
  }
  .status-card h3{
    margin:0;
    font-size:13px;
    color:var(--muted);
    font-weight:700;
  }
  .count{
    font-size:18px;
    font-weight:900;
    margin:6px 0 4px;
    color:var(--primary);
  }
  .list-info{ font-size:11px; color:var(--muted); }

  .btn-submit{
    width:100%;
    border:none;
    background:var(--primary);
    color:white;
    font-weight:900;
    border-radius:14px;
    padding:12px 14px;
    cursor:pointer;
  }
  .btn-submit:active{background:var(--primary-press)}
  .btn-submit[disabled]{opacity:.65;cursor:not-allowed}

  .footer-links{
    text-align:center;
    margin-top:10px;
  }
  .footer-links a{color:var(--primary);text-decoration:none;font-weight:700}
  #msg{font-size:13px; min-height:20px; margin:8px 0 2px}

  @media (max-width:640px){
    .form-grid{grid-template-columns:1fr}
    .status-grid{grid-template-columns:1fr}
    header.header-flex{flex-direction:column;align-items:flex-start}
  }
</style>
</head>

<body>
<div class="page">
  <div class="page-card">

    <header class="header-flex">
      <div class="brand-group">
        <img src="https://namyennn.github.io/room-booking/LOGOCS.png?v=1" alt="Logo">
        <div>
          <h1>‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h1>
          <div class="subtitle">Smart Booking System ‚Ä¢ CS Room</div>
        </div>
      </div>

      <select id="theme-select" style="width:auto; padding:6px 10px; border-radius:999px; font-size:12px;">
        <option value="auto">üåì Auto</option>
        <option value="light">‚òÄÔ∏è Light</option>
        <option value="dark">üåô Dark</option>
      </select>
    </header>

    <fieldset>
      <legend>üìç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</legend>

      <div style="margin-bottom: 12px;">
        <label>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</label>
        <select id="room"></select>
      </div>

      <div class="form-grid">
        <div>
          <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
          <input type="date" id="date">
        </div>

        <div class="form-grid" style="gap:10px;">
          <div>
            <label>‡πÄ‡∏£‡∏¥‡πà‡∏°</label>
            <input type="time" id="start">
          </div>
          <div>
            <label>‡∏ñ‡∏∂‡∏á</label>
            <input type="time" id="end">
          </div>
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</legend>
      <div class="status-grid">
        <div class="status-card">
          <h3>‡πÄ‡∏ä‡πâ‡∏≤</h3>
          <div id="c-morning" class="count">0</div>
          <div id="l-morning" class="list-info">‡∏ß‡πà‡∏≤‡∏á</div>
        </div>
        <div class="status-card">
          <h3>‡∏ö‡πà‡∏≤‡∏¢</h3>
          <div id="c-noon" class="count">0</div>
          <div id="l-noon" class="list-info">‡∏ß‡πà‡∏≤‡∏á</div>
        </div>
        <div class="status-card">
          <h3>‡πÄ‡∏¢‡πá‡∏ô</h3>
          <div id="c-evening" class="count">0</div>
          <div id="l-evening" class="list-info">‡∏ß‡πà‡∏≤‡∏á</div>
        </div>
      </div>
    </fieldset>

    <fieldset style="background: var(--bg); padding: 16px; border-radius: 14px; border: 1px dashed var(--border);">
      <legend>üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</legend>

      <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á (LINE Name)</label>
      <input id="by" placeholder="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å LINE..." readonly style="background: transparent;">

      <label style="margin-top: 12px;">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</label>
      <textarea id="purpose" rows="2" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á..."></textarea>
    </fieldset>

    <button id="book" class="btn-submit">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</button>

    <div class="footer-links">
      <p id="msg"></p>
      <a href="my.html">üìÇ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</a>
    </div>

  </div>
</div>

<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script>
/* ===================== CONFIG ===================== */
// ‚úÖ Web App ‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏°‡πà (‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á)
const API_URL = 'https://script.google.com/macros/s/AKfycbyKKtN_gWMWEW30eCjgfWSfF9m1AWPtYweRoPV7VPkPx21HoyhQO5oGGkbi08VsmcxCIQ/exec';
// ‚úÖ LIFF ID ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ô‡πâ‡∏≥‡πÄ‡∏¢‡πá‡∏ô
const LIFF_ID  = '2008386695-b1ykgdPk';
/* ================================================== */

const $ = (id)=>document.getElementById(id);

const state = {
  lineUserId: '',
  lineName: ''
};

function setMsg(t, cls=''){
  const el = $('msg');
  el.textContent = t || '';
  el.className = cls || '';
}

function applyTheme(v){
  document.body.classList.remove('force-light','force-dark');
  if(v==='light') document.body.classList.add('force-light');
  if(v==='dark') document.body.classList.add('force-dark');
}

function getTheme(){
  return localStorage.getItem('theme_select') || 'auto';
}

function ymd(d=new Date()){
  return d.toISOString().slice(0,10);
}

function pad2(n){ return String(n).padStart(2,'0'); }
function hm(d=new Date()){
  return `${pad2(d.getHours())}:${pad2(d.getMinutes())}`;
}

function timeToMin(t){
  const [h,m] = String(t||'').split(':').map(Number);
  if(Number.isNaN(h)||Number.isNaN(m)) return NaN;
  return h*60+m;
}

async function apiGet(qs){
  const url = API_URL + qs + (qs.includes('?') ? '&' : '?') + 'v=' + Date.now();
  const r = await fetch(url, { cache:'no-store' });
  const text = await r.text();
  try { return JSON.parse(text); }
  catch { throw new Error('BAD_JSON: '+text.slice(0,200)); }
}

async function apiPost(payloadObj){
  const form = new URLSearchParams();
  form.set('payload', JSON.stringify(payloadObj));
  const r = await fetch(API_URL, { method:'POST', body: form });
  const text = await r.text();
  try { return JSON.parse(text); }
  catch { throw new Error('BAD_JSON: '+text.slice(0,200)); }
}

/* ----------- ROOMS ----------- */
async function loadRooms(){
  $('room').innerHTML = '<option value="">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡πâ‡∏≠‡∏á...</option>';
  const d = await apiGet('?action=rooms');
  if(!d.ok) throw new Error(d.error || 'rooms_failed');

  const rooms = d.rooms || [];
  if(!rooms.length){
    $('room').innerHTML = '<option value="">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á</option>';
    return;
  }
  $('room').innerHTML = '<option value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á ‚Äî</option>';
  rooms.forEach(r=>{
    const opt = document.createElement('option');
    opt.value = r.room_id;
    opt.textContent = r.room_name ? `${r.room_name}` : r.room_id;
    $('room').appendChild(opt);
  });
}

/* ----------- SLOTS (‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ä‡πâ‡∏≤/‡∏ö‡πà‡∏≤‡∏¢/‡πÄ‡∏¢‡πá‡∏ô) ----------- */
function renderSlots(booked){
  const sections = [
    {key:'morning',  from:6*60,  to:12*60,  c:'c-morning',  l:'l-morning'},
    {key:'noon',     from:12*60, to:15*60,  c:'c-noon',     l:'l-noon'},
    {key:'evening',  from:15*60, to:19*60,  c:'c-evening',  l:'l-evening'}
  ];

  sections.forEach(sec=>{
    const list = booked.filter(b=>{
      const s=timeToMin(b.start), e=timeToMin(b.end);
      return Math.max(s,sec.from) < Math.min(e,sec.to);
    });

    $(sec.c).textContent = String(list.length);

    if(!list.length){
      $(sec.l).textContent = '‡∏ß‡πà‡∏≤‡∏á';
    }else{
      // ‡πÇ‡∏ä‡∏ß‡πå‡πÅ‡∏Ñ‡πà 3 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏ß
      $(sec.l).textContent = list.slice(0,3).map(x=>`${x.start}-${x.end}`).join(', ');
    }
  });
}

async function loadSlots(){
  const room_id = $('room').value;
  const date = $('date').value;
  if(!room_id || !date){
    renderSlots([]);
    return;
  }
  const d = await apiGet(`?action=slots&room_id=${encodeURIComponent(room_id)}&date=${encodeURIComponent(date)}`);
  if(!d.ok) throw new Error(d.error || 'slots_failed');
  renderSlots(d.booked || []);
}

/* ----------- LIFF ----------- */
async function initLiff(){
  try{
    await liff.init({ liffId: LIFF_ID });
    if(!liff.isLoggedIn()){
      $('by').value = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE ‡πÄ‡∏û‡∏∑‡πà‡∏≠ Login';
      setMsg('‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏ú‡πà‡∏≤‡∏ô LINE OA/LIFF ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≠‡∏á', 'bad');
      return;
    }
    const profile = await liff.getProfile();
    state.lineUserId = profile.userId;
    state.lineName = profile.displayName || '';
    $('by').value = state.lineName || '(‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠)';
    setMsg('');
  }catch(e){
    console.error(e);
    $('by').value = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LINE ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
    setMsg('LIFF error: ‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE OA/LIFF ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà', 'bad');
  }
}

/* ----------- BOOKING ----------- */
async function onBook(){
  const room_id = $('room').value;
  const date = $('date').value;
  const start = $('start').value;
  const end = $('end').value;
  const purpose = ($('purpose').value || '').trim();
  const book_by = (state.lineName || $('by').value || '').trim();
  const line_user = state.lineUserId;

  if(!line_user){
    alert('‡∏à‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\n\n‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE OA/LIFF ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á userId');
    return;
  }
  if(!room_id || !date || !start || !end){
    alert('‡∏à‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö');
    return;
  }
  const sMin=timeToMin(start), eMin=timeToMin(end);
  if(Number.isNaN(sMin) || Number.isNaN(eMin) || eMin<=sMin){
    alert('‡∏à‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\n\n‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (End ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ Start)');
    return;
  }

  $('book').disabled = true;
  setMsg('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏≠‡∏á...', '');

  try{
    const payload = {
      room_id, date, start, end,
      book_by, purpose,
      line_user
    };
    const r = await apiPost(payload);

    if(!r.ok){
      const human =
        r.error === 'TIME_CONFLICT' ? '‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏∑‡πà‡∏ô' :
        r.error === 'NO_LIFF' ? '‡πÑ‡∏°‡πà‡∏û‡∏ö line_user (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE)' :
        (r.message || r.error || '‡∏à‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
      setMsg('‚ùå '+human, 'bad');
      alert('‡∏à‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\n\n'+human);
      return;
    }

    setMsg('‚úÖ ‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! Ref: '+(r.ref||''), 'ok');
    alert(
      '‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à üéâ\n\n' +
      `‡∏´‡πâ‡∏≠‡∏á: ${room_id}\n` +
      `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${date}\n` +
      `‡πÄ‡∏ß‡∏•‡∏≤: ${start} - ${end}\n` +
      `Ref: ${r.ref||'-'}`
    );
    await loadSlots();
  }catch(e){
    console.error(e);
    setMsg('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠', 'bad');
    alert('‡∏à‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\n\n‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠');
  }finally{
    $('book').disabled = false;
  }
}

/* ----------- INIT ----------- */
document.addEventListener('DOMContentLoaded', async ()=>{
  // theme init
  const t = getTheme();
  $('theme-select').value = t;
  applyTheme(t);
  $('theme-select').addEventListener('change', (e)=>{
    const v=e.target.value;
    localStorage.setItem('theme_select', v);
    applyTheme(v);
  });

  // defaults
  $('date').value = ymd();
  const d = new Date();
  d.setMinutes(d.getMinutes()+10);
  $('start').value = hm(d);
  d.setMinutes(d.getMinutes()+30);
  $('end').value = hm(d);

  // load rooms & slots
  try{
    await loadRooms();
  }catch(e){
    console.error(e);
    $('room').innerHTML = '<option value="">‡πÇ‡∏´‡∏•‡∏î‡∏´‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</option>';
    setMsg('‡πÇ‡∏´‡∏•‡∏î‡∏´‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÄ‡∏ä‡πá‡∏Ñ Apps Script action=rooms)', 'bad');
  }

  // LIFF
  await initLiff();

  // events
  $('room').addEventListener('change', loadSlots);
  $('date').addEventListener('change', loadSlots);
  $('book').addEventListener('click', onBook);

  // initial slots (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå‡∏ß‡πà‡∏≤‡∏á)
  await loadSlots();
});
</script>
</body>
</html>
